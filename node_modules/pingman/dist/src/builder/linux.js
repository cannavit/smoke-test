"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const messages_1 = require("../messages");
const process_1 = require("process");
const linux = (ip, options) => {
    let defaultNumberOfEchoes = '4';
    let args = [];
    let buildCommand = {
        command: 'ping',
        arguments: args
    };
    //NO Allowing Unsanitized user input into spawn.Checking each param and assigning
    if (!options) {
        buildCommand.arguments.push('-c', defaultNumberOfEchoes);
        args.push(ip);
        return buildCommand;
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.numberOfEchos) === 'number') {
        args.push('-c', options.numberOfEchos.toString());
    }
    else {
        args.push('-c', defaultNumberOfEchoes);
    }
    if (options === null || options === void 0 ? void 0 : options.soDebugOption) {
        args.push('-d');
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.interval) === 'number') {
        if (options === null || options === void 0 ? void 0 : options.floodPing) {
            args.push('-f');
            process_1.emitWarning(messages_1.ERROR_MESSAGES.FLOOD_AND_INTERVAL_ARGS, 'argumentWarning'); //Catch the warning and process it
        }
        else {
            args.push('-i', options === null || options === void 0 ? void 0 : options.interval.toString());
        }
    }
    if (options === null || options === void 0 ? void 0 : options.floodPing) {
        if (typeof (options === null || options === void 0 ? void 0 : options.interval) === 'number') {
            args.push('-i', options === null || options === void 0 ? void 0 : options.interval.toString());
            process_1.emitWarning(messages_1.ERROR_MESSAGES.FLOOD_AND_INTERVAL_ARGS, 'argumentWarning');
        }
        else {
            args.push('-f');
        }
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.interfaceAddress) === 'string') {
        args.push('-I', options.interfaceAddress);
    }
    if (options === null || options === void 0 ? void 0 : options.suppressLoopback) {
        args.push('-L');
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.TTL) === 'number') {
        args.push('-t', options.TTL.toString());
    }
    if (options === null || options === void 0 ? void 0 : options.numeric) {
        args.push('-n');
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.pattern) === 'string') {
        args.push('-p', options.pattern);
    }
    if (options === null || options === void 0 ? void 0 : options.quiet) {
        args.push('-q');
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.bufferSize) === 'number') {
        args.push('-s', options.bufferSize.toString());
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.timeBeforeExit) === 'number') {
        args.push('-W', options.timeBeforeExit.toString());
    }
    if (options === null || options === void 0 ? void 0 : options.verboseOutput) {
        args.push('-v');
    }
    if (typeof (options === null || options === void 0 ? void 0 : options.timeout) === 'number') {
        args.push('-w', options.timeout.toString());
    }
    if (options === null || options === void 0 ? void 0 : options.IPV6) {
        buildCommand.command = 'ping6';
    }
    args.push(ip);
    buildCommand.arguments = args;
    return buildCommand;
};
exports.default = linux;
